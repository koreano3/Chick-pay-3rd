{% extends 'base.html' %}
{% block title %}Chick Pay - ì¶œê¸ˆ ì™„ë£Œ{% endblock %}
{% block content %}

{% load humanize %}
<main class="container mx-auto px-4 py-10 flex-grow">
    <div class="max-w-4xl mx-auto">
        <div class="flex items-center mb-8">
            <a href="{% url 'cash-withdraw' %}" class="text-chick-brown hover:underline flex items-center">
                <span class="mr-2">â†</span> ì¶œê¸ˆ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°
            </a>
        </div>
        <div class="bg-white rounded-3xl p-8 shadow-lg mb-8">
            <h2 class="text-2xl font-bold text-chick-brown mb-6 flex items-center">
                <span class="text-3xl mr-3">ğŸ’°</span> ì¶œê¸ˆ ìƒì„¸ ì •ë³´
            </h2>

            <div
                class="bg-gradient-to-r from-chick-yellow to-chick-orange rounded-2xl p-6 text-chick-brown shadow-md mb-8">
                <div class="flex justify-between items-center mb-4">
                    <span class="font-bold text-xl">Cash</span>
                    <span class="text-3xl">ğŸ¦</span>
                </div>
                <div class="text-2xl font-bold mb-2">{{email}}</div>
                <div class="flex justify-between items-center">
                    <span class="text-lg">{{ name }}</span>
                    <span class="font-bold text-3xl">â‚© {{ balance|floatformat:"0"|intcomma }}</span>
                </div>
            </div> 

            <div class="mb-8">
                <h3 class="text-xl font-bold text-chick-brown mb-4">ì¶œê¸ˆ ë‚´ì—­</h3>

                <div class="bg-chick-light rounded-xl p-6 mb-6">
                    <div class="flex justify-between items-center mb-3">
                        <span class="font-bold">ì¶œê¸ˆ ê¸ˆì•¡</span>
                        <span class="text-2xl font-bold text-chick-brown">                      
                        {% if recent_withdraws.0 %}
                            â‚© {{recent_withdraws.0.amount|floatformat:"0"|intcomma }}
                          {% else %}
                            â‚© 0
                          {% endif %}
                        </span>
                    </div>
                    <div class="flex justify-between items-center mb-3">
                        <!-- <span>ì¶œê¸ˆ ë°©ë²•</span> -->
                    </div>
                    <div class="flex justify-between items-center mb-3">
                        <span>ì¶œê¸ˆ ì¼ì‹œ</span>
                        <span>    {% if recent_withdraws %}
                            {{ recent_withdraws.0.created_at|date:"Yë…„ nì›” jì¼ H:i" }}
                          {% else %}
                            ë‚´ì—­ ì—†ìŒ
                          {% endif %}</span>
                    </div>
                    <div class="flex justify-between items-center mb-3">
                        <span>ê±°ë˜ ID</span>
                        <span class="text-gray-500 text-sm">DP2025040154321</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>ìƒíƒœ</span>
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">ì™„ë£Œ</span>
                    </div>
                </div>

            <div class="border-t border-gray-200 pt-6">
                <h3 class="text-xl font-bold text-chick-brown mb-4">ì¶œê¸ˆ í›„ ì”ì•¡</h3>
                <div class="flex justify-between items-center">
                    <span>ì´ì „ ì”ì•¡</span>
                    <span>â‚©  {{previous_balance|floatformat:"0"|intcomma}} </span>
                </div>
                <div class="flex justify-between items-center mb-2">
                    <span>ì¶œê¸ˆ ê¸ˆì•¡</span>
                    <span class="text-red-500">- â‚© {{recent_withdraws.0.amount|floatformat:"0"|intcomma }}</span>
                </div>
                <div class="flex justify-between items-center font-bold text-lg">
                    <span>í˜„ì¬ ì”ì•¡</span>
                    <span class="text-chick-brown">â‚© {{ balance|floatformat:"0"|intcomma }}</span>
                </div>
            </div>
        </div>
<!-- ================================ìµœê·¼ ì¶œê¸ˆ ë‚´ì—­==================================== -->
<!-- ìµœì‹ ì¶œê¸ˆë‚´ì—­ 3ê°œ  -->
    <div class="bg-white rounded-3xl p-8 shadow-lg">
        <h3 class="text-xl font-bold text-chick-brown mb-6">ìµœê·¼ ì¶œê¸ˆ ë‚´ì—­</h3>
    
        <div class="space-y-4">
            <!-- ì²« ë²ˆì§¸ ìµœì‹  ì¶œê¸ˆ -->
            {% if recent_withdraws.0 %}
            <div class="flex justify-between items-center p-4 border-b border-gray-100">
                <div>
                    <div class="font-medium">
                        {% if recent_withdraws.0.bank_name %}
                            {{ recent_withdraws.0.bank_name }}
                        {% else %}
                            ì¶œê¸ˆ
                        {% endif %}
                    </div>
                    <div class="text-sm text-gray-500">
                        {{ recent_withdraws.0.created_at|date:"Yë…„ nì›” jì¼ H:i" }}
                    </div>
                </div>
                <div class="text-right">
                    <div class="font-bold text-red-500">- â‚© {{ recent_withdraws.0.amount|floatformat:"0"|intcomma }}</div>
                    <div class="text-sm text-gray-500">
                        {% if recent_withdraws.0.transaction_method %}
                            {{ recent_withdraws.0.transaction_method }}
                        {% else %}
                            ê³„ì¢Œ ì´ì²´
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}
    
            <!-- ë‘ ë²ˆì§¸ ìµœì‹  ì¶œê¸ˆ -->
            {% if recent_withdraws.1 %}
            <div class="flex justify-between items-center p-4 border-b border-gray-100">
                <div>
                    <div class="font-medium">
                        {% if recent_withdraws.1.bank_name %}
                            {{ recent_withdraws.1.bank_name }}
                        {% else %}
                            ì¶œê¸ˆ
                        {% endif %}
                    </div>
                    <div class="text-sm text-gray-500">
                        {{ recent_withdraws.1.created_at|date:"Yë…„ nì›” jì¼ H:i" }}
                    </div>
                </div>
                <div class="text-right">
                    <div class="font-bold text-red-500">- â‚© {{ recent_withdraws.1.amount|floatformat:"0"|intcomma }}</div>
                    <div class="text-sm text-gray-500">
                        {% if recent_withdraws.1.transaction_method %}
                            {{ recent_withdraws.1.transaction_method }}
                        {% else %}
                            ê³„ì¢Œ ì´ì²´
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}
    
            <!-- ì„¸ ë²ˆì§¸ ìµœì‹  ì¶œê¸ˆ -->
            {% if recent_withdraws.2 %}
            <div class="flex justify-between items-center p-4">
                <div>
                    <div class="font-medium">
                        {% if recent_withdraws.2.bank_name %}
                            {{ recent_withdraws.2.bank_name }}
                        {% else %}
                            ì¶œê¸ˆ
                        {% endif %}
                    </div>
                    <div class="text-sm text-gray-500">
                        {{ recent_withdraws.2.created_at|date:"Yë…„ nì›” jì¼ H:i" }}
                    </div>
                </div>
                <div class="text-right">
                    <div class="font-bold text-red-500">- â‚© {{ recent_withdraws.2.amount|floatformat:"0"|intcomma }}</div>
                    <div class="text-sm text-gray-500">
                        {% if recent_withdraws.2.transaction_method %}
                            {{ recent_withdraws.2.transaction_method }}
                        {% else %}
                            ê³„ì¢Œ ì´ì²´
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}
    
            {% if not recent_withdraws %}
                <div class="text-center text-gray-500 py-4">
                    ì¶œê¸ˆ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.
                </div>
            {% endif %}
        </div>


            <div class="mt-6 text-center">
                <a href="#" onclick="toggleTransactions(event)" class="text-chick-brown hover:underline text-sm">ëª¨ë“  ì¶œê¸ˆ ë‚´ì—­ ë³´ê¸°</a>
            </div>


        <div id="fullTransactionList" class="container mx-auto px-4 py-8" style="display: none;">
        <div class="bg-white rounded-3xl p-8 shadow-lg">
        <h3 class="text-xl font-bold text-chick-brown mb-6">ì „ì²´ ì¶œê¸ˆ ë‚´ì—­</h3>
        
        <div class="space-y-4">
            {% for tx in recent_withdraws %}
                <div class="flex justify-between items-center p-4 {% if not forloop.last %}border-b border-gray-100{% endif %}">
                    <div>
                        <div class="font-medium">
                            {% if tx.bank_name %}
                                {{ tx.bank_name }}
                            {% else %}
                                ì¶œê¸ˆ
                            {% endif %}
                        </div>
                        <div class="text-sm text-gray-500">
                            {{ tx.created_at|date:"Yë…„ nì›” jì¼ H:i" }}
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-red-500">- â‚© {{ tx.amount|floatformat:"0"|intcomma }}</div>
                        <div class="text-sm text-gray-500">
                            {% if tx.transaction_method %}
                                {{ tx.transaction_method }}
                            {% else %}
                                ê³„ì¢Œ ì´ì²´
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% empty %}
                <div class="text-center text-gray-500 py-4">
                    ì¶œê¸ˆ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.
                </div>
            {% endfor %}
        </div>
        </div>
    </div>
</main>


<script>
    function toggleTransactions(event) {
        event.preventDefault(); // ê¸°ë³¸ ë§í¬ ë™ì‘ ë°©ì§€
        
        const transactionList = document.getElementById('fullTransactionList');
        const button = event.target;
    
        if (transactionList.style.display === 'none') {
            // ìˆ¨ê²¨ì ¸ ìˆì„ ë•Œ -> ë³´ì—¬ì£¼ê¸°
            transactionList.style.display = 'block';
            button.textContent = 'ì¶œê¸ˆ ë‚´ì—­ ì ‘ê¸°';
        } else {
            // ë³´ì—¬ì§ˆ ë•Œ -> ìˆ¨ê¸°ê¸°
            transactionList.style.display = 'none';
            button.textContent = 'ëª¨ë“  ì¶œê¸ˆ ë‚´ì—­ ë³´ê¸°';
        }
    }
    </script>

    
{% endblock %}